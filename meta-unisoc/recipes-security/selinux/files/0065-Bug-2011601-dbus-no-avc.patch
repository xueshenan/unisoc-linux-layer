From 38be34742ef580647048a842d4aa77e9a07e4966 Mon Sep 17 00:00:00 2001
From: "hainan.wang" <hainan.wang@unisoc.com>
Date: Tue, 11 Oct 2022 13:47:46 +0800
Subject: [PATCH] Bug #2011601 dbus-no-avc

[root cause  ]: x
[changes     ]:x
[side effects]:x
[self test   ]:x
[download normally]:x
[power on/off normally]:x
[do common repository/branch inspection]:x
[is there dependence]:x
[confirm dependent commit]:x
[board]:x
[test case]:x
[reviewers]:x

commit_template_version:v1
---
 policy/modules/roles/sysadm.if | 8 ++++++++
 policy/modules/roles/sysadm.te | 1 +
 2 files changed, 9 insertions(+)

diff --git a/policy/modules/roles/sysadm.if b/policy/modules/roles/sysadm.if
index 0506d733f..f8b434dbc 100644
--- a/policy/modules/roles/sysadm.if
+++ b/policy/modules/roles/sysadm.if
@@ -662,3 +662,11 @@ interface(`sysadm_var_t_dir',`
     allow $1 var_t:dir {mounton};
 ')
 
+interface(`sysadm_sysadm_t_dbus',`
+    gen_require(`
+        type sysadm_t;
+    ')
+
+    allow $1 sysadm_t:dbus {acquire_svc};
+')
+
diff --git a/policy/modules/roles/sysadm.te b/policy/modules/roles/sysadm.te
index 60aed0cd2..5ecd1da43 100644
--- a/policy/modules/roles/sysadm.te
+++ b/policy/modules/roles/sysadm.te
@@ -1391,4 +1391,5 @@ sysadm_unlabeled_t_filesystem(sysadm_t)
 sysadm_etc_t_dir(sysadm_t)
 sysadm_home_root_t_dir(sysadm_t)
 sysadm_var_t_dir(sysadm_t)
+sysadm_sysadm_t_dbus(sysadm_t)
 
-- 
2.17.1

