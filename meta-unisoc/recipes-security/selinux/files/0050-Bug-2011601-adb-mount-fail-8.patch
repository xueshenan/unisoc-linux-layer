From 7c037237b0e9e2692e372412c753ec54a8f3122b Mon Sep 17 00:00:00 2001
From: "hainan.wang" <hainan.wang@unisoc.com>
Date: Sat, 8 Oct 2022 20:11:03 +0800
Subject: [PATCH] Bug #2011601-adb-mount-fail-8.patch

[root cause  ]: x
[changes     ]:x
[side effects]:x
[self test   ]:x
[download normally]:x
[power on/off normally]:x
[do common repository/branch inspection]:x
[is there dependence]:x
[confirm dependent commit]:x
[board]:x
[test case]:x
[reviewers]:x

commit_template_version:v1
---
 policy/modules/services/gpsd.if | 10 +++++++++-
 policy/modules/services/gpsd.te |  1 +
 2 files changed, 10 insertions(+), 1 deletion(-)

diff --git a/policy/modules/services/gpsd.if b/policy/modules/services/gpsd.if
index 0545b98b4..05b27c307 100644
--- a/policy/modules/services/gpsd.if
+++ b/policy/modules/services/gpsd.if
@@ -185,7 +185,7 @@ interface(`gpsd_device_t_file',`
         type device_t;
     ')
 
-   allow $1 device_t:file {write map open read append ioctl};
+   allow $1 device_t:file {write map open read append ioctl getattr};
 ')
 
 interface(`gpsd_var_t_dir',`
@@ -212,3 +212,11 @@ interface(`gpsd_var_t_sock_file',`
    allow $1 var_t:sock_file {write map open read create getattr append};
 ')
 
+interface(`gpsd_var_t_file',`
+    gen_require(`
+        type var_t;
+    ')
+
+   allow $1 var_t:file {write map open read create getattr append};
+')
+
diff --git a/policy/modules/services/gpsd.te b/policy/modules/services/gpsd.te
index 1cab19c4a..61baacacb 100644
--- a/policy/modules/services/gpsd.te
+++ b/policy/modules/services/gpsd.te
@@ -97,4 +97,5 @@ gpsd_device_t_file(gpsd_t)
 gpsd_var_t_dir(gpsd_t)
 gpsd_device_t_chr_file(gpsd_t)
 gpsd_var_t_sock_file(gpsd_t)
+gpsd_var_t_file(gpsd_t)
 
-- 
2.17.1

